<!DOCTYPE html>

<html
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns:th="http://www.w3.org/1999/xhtml"
        layout:decorator="base">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <link rel="stylesheet" type="text/css" th:href="@{/webjars/mirador/2.1.2/css/mirador-combined.css}" />
    <style type="text/css">
      body { font-size: 14px; }
      /*body { padding: 0; margin: 0; overflow: hidden; font-size: 70%; }*/
      #viewer { background: #333; width: 100%; height: 800px; position: relative; }
    </style>
  </head>
  <body>
    <section layout:fragment="content">
      <div class="row">
        <div class="col-md-12">
          <div id="viewer"></div>
        </div>
      </div>
    </section>

    <th:block layout:fragment="morejs">
      <script th:src="@{/webjars/mirador/2.1.2/mirador.min.js}"></script>
      <script type="text/javascript" th:inline="javascript">
        /*<![CDATA[*/
        function getParams() {
          var params={};
          window.location.search
              .replace(/[?&]+([^=&]+)=([^&]*)/gi, function(str,key,value) {
                    params[key] = value;
                  }
              );
          return params
        }
        /*]]>*/

        $(function(){
          var requestParams = getParams();
          var canvasUri = requestParams.canvas || /*[[@{__${presentationUri}__/canvas/p1}]]*/;
          Mirador({
            'buildPath': /*[[@{/webjars/mirador/2.1.2/}]]*/,
            "id": "viewer",
            "workspaceType": "singleObject",
            'mainMenuSettings': {
              'show': true,
              'buttons': {
                'bookmark': true,
                'layout': true
              },
              'userLogo': {
                'label': 'Mirador',
                'attributes': { 'href': 'http://projectmirador.org/' }
              },
              "userButtons": [
                {
                  "label": "IIIF-Manifest",
                  "iconClass": "fa fa-file-text",
                  "attributes": {
                    "class": "file",
                    "href": /*[[@{__${presentationUri}__/manifest}]]*/,
                    "target": "_blank"
                  }
                }
              ]
            },
            "layout": "1x1",
            "data": [
              {
                /*<![CDATA[*/
                "manifestUri": /*[[@{__${presentationUri}__/manifest}]]*/
                /*]]>*/
              }
            ],
            "windowObjects": [
              {
                /*<![CDATA[*/
                "loadedManifest": /*[[@{__${presentationUri}__/manifest}]]*/,
                /*]]>*/
                /*<![CDATA[*/
                "canvasID": canvasUri,
                /*]]>*/
                "viewType": "ImageView",
                "layoutOptions": {
                  "close": false,
                  "slotRight": false,
                  "slotLeft": false,
                  "slotAbove": false,
                  "slotBelow": false
                },
                "sidePanelOptions": {
                  "toc" : true,
                  "annotations" : false
                },
                "annotationLayer": false,
                "annotationCreation": false,
                "annotationState": 'annoOff',
                "saveSession": false
              }]
            /*,
            "annotationEndpoint": {
              "name": 'Local Storage Endpoint',
              "module": 'LocalStorageEndpoint'
            }
            */
          });
        });
      </script>
    </th:block>
  </body>
</html>
